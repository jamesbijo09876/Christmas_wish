<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Christmas Countdown</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  :root{
    --bg-1: #0b1320;
    --bg-2: #2b1b3b;
    --accent: #ffd166;
    --muted: rgba(255,255,255,0.8);
  }

  html,body{
    height:100%;
    margin:0;
    font-family:"Poppins", sans-serif;
    background: linear-gradient(180deg, var(--bg-1), var(--bg-2));
    color:white;
    overflow:hidden;
  }

  .wrap{position:relative;height:100vh;display:flex;align-items:center;justify-content:center;padding:48px;box-sizing:border-box;}

  .card{
    width:min(960px,94vw);
    background:rgba(255,255,255,0.03);
    border-radius:18px;
    padding:48px;
    box-shadow:0 10px 40px rgba(0,0,0,0.6);
    backdrop-filter:blur(6px);
    position:relative;
    overflow:hidden;
  }

  .top-row{display:flex;justify-content:space-between;align-items:flex-start;gap:24px;flex-wrap:wrap;}
  h1{font-family:"Playfair Display";font-weight:900;margin:0;line-height:0.92;font-size:clamp(36px,8vw,84px);color:white;}

  p.lead{margin:18px 0 28px;opacity:0.95;font-size:1.05rem;}
  #countdown{font-size:1.3rem;margin:16px 0 28px;font-weight:600;color:#ffd166;}

  footer{margin-top:26px;font-size:0.85rem;color:rgba(255,255,255,0.65);display:flex;justify-content:flex-end;}

  #snow-canvas{position:fixed;inset:0;z-index:0;pointer-events:none;}

  /* Modal */
  .modal{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.7);
    justify-content:center;
    align-items:center;
    z-index:999;
  }
  .modal-content{
    background:#ffffff10;
    padding:22px;
    border-radius:14px;
    width:90%;
    max-width:420px;
    backdrop-filter:blur(8px);
    text-align:center;
  }
  .modal input, .modal textarea{
    width:100%;
    margin:8px 0;
    padding:10px;
    border-radius:8px;
    border:none;
    font-size:1rem;
  }
  .modal button{
    margin-top:10px;
    padding:10px 16px;
    border:none;
    border-radius:8px;
    background:var(--accent);
    color:black;
    font-weight:600;
    cursor:pointer;
  }

  /* Enhancements */
  .fade-in{
    animation:fadeIn 1.2s ease-out forwards;
    opacity:0;
  }
  @keyframes fadeIn{
    from{opacity:0;transform:translateY(10px);}
    to{opacity:1;transform:translateY(0);}
  }
  .name-glow{
    color:var(--accent);
    text-shadow:0 0 8px var(--accent),0 0 14px var(--accent);
  }
</style>
</head>
<body>

<canvas id="snow-canvas"></canvas>

<audio id="bg-music" autoplay loop muted>
  <source src="assets/audio/polar-express.mp3" type="audio/mp3">
</audio>

<div class="wrap">
  <div class="card" role="main">
    <div class="top-row">
      <div>
        <h1>Merry Christmas üéÑ</h1>
        <p class="lead">The gift of love. The gift of peace. The gift of happiness. May all these be yours at Christmas.</p>
        <div id="countdown"></div>

        <button id="openModalBtn" style="padding:10px 16px; border:none; border-radius:8px; background:var(--accent); color:black; font-weight:600; cursor:pointer;">
          ‚ú® Create Christmas Wish
        </button>
      </div>
    </div>

    <footer>
      <div>Made by Bijo</div>
    </footer>
  </div>
</div>

<!-- Modal Form -->
<div class="modal" id="wishModal">
  <div class="modal-content">
    <h3>Create Your Wish üéÅ</h3>
    <input type="text" id="toInput" placeholder="To *">
    <textarea id="msgInput" rows="4" placeholder="Your Christmas Message *"></textarea>
    <input type="text" id="fromInput" placeholder="From *">

    <button id="generateBtn">Create Link</button>
    <button id="copyBtn">Copy Link</button>
    <button onclick="closeModal()">Close</button>
  </div>
</div>

<script>
// Modal Logic
const modal=document.getElementById("wishModal");
document.getElementById("openModalBtn").onclick=()=>modal.style.display="flex";
function closeModal(){modal.style.display="none"}

// Generate link
let generatedLink="";
document.getElementById("generateBtn").onclick=()=>{
  const to=document.getElementById("toInput").value;
  const msg=document.getElementById("msgInput").value;
  const from=document.getElementById("fromInput").value;

  if(!to || !msg || !from){
    alert("Please fill all fields");
    return;
  }

  const base=location.origin+location.pathname;
  generatedLink=`${base}?to=${encodeURIComponent(to)}&msg=${encodeURIComponent(msg)}&from=${encodeURIComponent(from)}`;
  alert("Link Created! Now click Copy Link.");
}

// Copy link
document.getElementById("copyBtn").onclick=()=>{
  if(!generatedLink) return alert("Create link first");
  navigator.clipboard.writeText(generatedLink);
  alert("Link Copied ‚úÖ");
}

// Display message if shared link opened
const params=new URLSearchParams(location.search);
if(params.has("msg")){
  const to=decodeURIComponent(params.get("to"));
  const msg=decodeURIComponent(params.get("msg"));
  const from=decodeURIComponent(params.get("from"));

  document.querySelector("p.lead").style.display="none";
  document.getElementById("countdown").style.display="none";
  document.getElementById("openModalBtn").style.display="none";

  document.querySelector("p.lead").insertAdjacentHTML("afterend",`
    <div class="fade-in" style="font-size:1.2rem;line-height:1.45;max-width:500px;margin-top:10px;white-space:pre-line;">
      <span style="opacity:0.9;">To: </span><strong class="name-glow">${to}</strong>

      <br><br>üéÑ ${msg}

      <br><br><span style="opacity:0.9;">From: </span><strong class="name-glow">${from}</strong>

      <br><br>
      <button onclick="location.href=location.origin+location.pathname">üéÖ View Another Wish</button>
      <button onclick="window.open('https://wa.me/?text='+encodeURIComponent('üéÑ Wish to: ${to}\\n${msg}\\nFrom: ${from}\\n'+location.href),'_blank')">Share on WhatsApp</button>
    </div>
  `);
}

// Countdown Script
function updateCountdown(){
  const christmas=new Date("December 25, 2025 00:00:00").getTime();
  const now=new Date().getTime();
  const diff=christmas-now;
  if(diff<=0){document.getElementById("countdown").innerHTML="üéÖ Merry Christmas! üéÑ";return;}
  const days=Math.floor(diff/(1000*60*60*24));
  const hours=Math.floor((diff%(1000*60*60*24))/(1000*60*60));
  const mins=Math.floor((diff%(1000*60*60))/(1000*60));
  const secs=Math.floor((diff%(1000*60))/1000);
  document.getElementById("countdown").innerHTML=`${days}d ${hours}h ${mins}m ${secs}s`;
}
setInterval(updateCountdown,1000);
updateCountdown();

// Snowfall Script
const canvas=document.getElementById("snow-canvas");
const ctx=canvas.getContext("2d");
let w=canvas.width=innerWidth;
let h=canvas.height=innerHeight;
onresize=()=>{w=canvas.width=innerWidth;h=canvas.height=innerHeight}
const flakes=[];
for(var i=0;i<150;i++){
  flakes.push({x:Math.random()*w,y:Math.random()*h,r:Math.random()*3+1,d:Math.random()+1});
}
function draw(){
  ctx.clearRect(0,0,w,h);
  ctx.fillStyle="white";
  ctx.beginPath();
  flakes.forEach(f=>{ctx.moveTo(f.x,f.y);ctx.arc(f.x,f.y,f.r,0,Math.PI*2)});
  ctx.fill();
  flakes.forEach(f=>{f.y+=Math.pow(f.d,2);if(f.y>h){f.y=0;f.x=Math.random()*w;}});
}
setInterval(draw,33);

// Enable music after user interaction
addEventListener("click",()=>{
  const m=document.getElementById("bg-music");
  m.muted=false;
  m.play();
},{once:true});
</script>

</body>
</html>
